# 05_函数

## 1.函数的概念和作用

概念：函数是将若干行代码以一种语法形式包装成的一个整体

作用：函数时解决在不同情形下需要执行相同代码的有效方式，即所谓的代码重用

## 2.函数的定义和语法

语法形式：

```php
function 函数名($形参1, $形参2,....){
	函数体语句块
}
函数名($实参1,$实参2,....);//调用
```

说明：

1. 函数的命名规则和变量名一样
2. 定义函数的目的就是为了以后能够调用
3. 调用函数，其实就是执行函数内的代码
4. 形参，其实就是变量，是只能在函数内部使用的变量
5. 实参，其实就是数据，是会传入函数内部的数据（是一一对应地赋值给形参）

## 3.函数执行原理

1. 程序总是运行在一个“内存空间”
2. 程序开始执行的位置所在空间，称之为“主运行空间”
3. 函数的运行（调用），都是在单独的一个空间中

如下：

![](C:\Users\宋天\Desktop\php\img\函数运行.png)

## 4.函数参数

1. 形参

   概念：就是定义函数的时候，在函数名后面的小括号中给出的变量名

   作用范围：形参只能在函数内部使用，即该变量的使用范围仅仅局限于当前函数内部

   形参的本质是变量

2. 实参

   概念：就是在调用函数的时候，在函数名后面的小括号内给出的数据值

   实参的本质是数据

3. 函数参数的传递方式

   - 引用传递

     可以使用`&`符号设定为引用传递

     ```php
     function f1($p1, $p2, &$p3){
     	
     }
     ```

     注意：此时在函数内部，对该形参变量改变其值，则对应的实参变量（在函数外部）的值也改变了

     案例：

     ```php
     function f1($p1, &$p2){
     	$p1++;
     	$p2++;
     	$s = $p1 + $p2;
     	return $s;
     }
     
     $v1 = 10;
     $v2 = 20;
     $s = f1($v1,$v2);
     //$s = f1(10,20);//报错
     echo "s=$s,v1=$v1,v2=$v2";//s=32,v1=10,v2=21
     ```

     注意：引用传递不能直接传递数据值，具体的数据不能以引用的方式传给$p2

   - 值传递

     就是普通的数据传递

4. 形参的默认值

   - 形参可以设定默认值，格式为：`$形参名=值`
   - 设定默认值得形参只能放在没有设定默认值的形参后面
   - 设定了默认值的形参对应的实参可以不提供数据，此时就会使用该默认值当做该实参得数据

   案例：

   ```php
   function f1($p1,$p2=1,$p3=true){
   	语句块
   }
   ```

## 5.函数返回值

概念：一个函数在执行结束时，可以让其返回一个数据，这就是函数的返回值

语法：`return 返回值`

说明：

- 一般情况下，一个函数执行结束都是需要返回一个数据值的
- 函数也可以在执行的中途返回数据，此时，函数结束
- 一个函数执行得到的返回值，可以在任何需要数据的场合使用，和使用一个变量一样
- return也可以不返回任何数据，此时就只是单纯的结束函数，并不返回数据，也可以说是返回一个null
- 只要执行到return语句，函数就会结束，是否返回数据，看该行代码

## 6.可变函数

概念：所谓可变函数，就是函数名是一个变量的情形

注意：定义函数的时候，不可以使用可变函数名

对比：

- 可变变量，就是变量名就是一个变量，比如`$$f1`
- 可变函数，就是函数名是一个变量，比如：
  - 调用函数f1的语法是：f1();
  - 可以使用可变函数的语法来调用：`$func_name="f1"`

可变函数的本质就是：一个变量的内容是一个字符串，该字符串是一个函数的名字

案例：

```php
function f1(){}

$f = "f1";
$f();//调用函数f1，这就是可变函数
```

## 7.匿名函数

概念：就是定义一个没有名字的函数

案例：

```php
$f1 = function(){}
$f1();//调用匿名函数的形式
```

## 8.常用系统函数介绍

自行查手册

1. 跟函数有关的函数

   - function_exists("函数名");

     判断一个函数是否已经存在

   - func_get_arg($n);

     在函数内部使用，用于获得第n个实参（n从0开始算起）

   - func_get_args();

     在函数内部使用，用于获得所有的实参，结果为一个数组

   - func_num_args();

     在函数内部使用，用于获得实参的个数

2. 字符串有关的常用函数

   - 输出与格式化

     ```
     echo, print, printf, print_r, var_dump
     ```

   - 字符串去除与填充

     ```
     trim,ltrim,rtrim,str_pad
     ```

   - 字符串连接与分割

     ```
     implode, join， explode, str_split
     ```

   - 字符串截取

     ```
     substr, strchr, strrchr
     ```

   - 字符串替换

     ```
     str_replace, substr_replace
     ```

   - 字符串长度与位置

     ```
      strlen, strpos, strrpos
     ```

   - 字符转换

     ```
     strtolower, strtoupper, lcfirst, ucfirst, ucwords
     ```

   - 特殊字符处理

     ```
     nl2br, addslashes, htmlspecialchars, htmlspecialchars_decode,
     ```

3. 常用数学函数

   - max

     取得若干个数据中的最大值

   - min

     取得若干个数据中的最小值

   - round

     对某个数据进行四舍五入，可以设定保留多少小数

   - ceil

     向上取整

   - floor

     向下取整

   - abs

     取得某个数的绝对值

   - sqrt

     计算某个数的开放值

   - pow

     幂运算

   - rand

     获得两位数之间的随机整数

   - mt_rand

     获得某两位数之间的随机整数，比rand更快

4. 常用时间函数

   - time

     获得当前时间，精确到秒，结果为一个整数，代表从1970年1月1日0:0:0秒到当前时刻的秒数。

   - microtime

     获得当前时间，可以精确到微秒

     有两个用法

     - microtime(true)

       获得秒数（和time一样），是一个数字（浮点数，有四位小数）

     - microtime(false)

       获得秒数，但因为精度太高，导致浮点数无法表达出来，所以返回一个字符串

   - mktime

     创建一个时间数据，参数为：时，分，秒，日，月，年

   - date

     将一个时间转换为某种字符串形式

     eg：`data(Y-m-d H:i:s)`

   - idate

     取得一个时间的某个单项数据值

     eg：`idate("Y");` 取得年份

   - strtotime

     讲一个字符串转换为时间值

   - date_default_timezone_set

     在代码中设置“时区”

   - date_default_timezone_get

     在代码中获取“时区”

## 9.函数作用域

1. 变量的作用域问题

   共有三种作用域：局部作用域，全局作用域，超全局作用域

   对应的有三种变量：局部变量，全局变量，超全局变量

2. 局部作用域和局部变量

   概念：函数内部范围的作用域，其中定义的变量就是局部变量（包括形参也是局部变量）

   访问范围：只能在其所在的局部作用域中使用

   注意：局部变脸在函数调用结束时，被销毁

   ```php
   $v1 = 1;
   function f1($p1,$p2){
   	$v2 = 2;
   	echo $v2;
   	echo $v1;//报错，变量未定义
   }
   f1(4,5)
   echo $v1;
   echo $v2;//报错，变量未定义
   ```

3. 静态变量

   概念：在函数内部使用static关键字修饰的变量

   格式：

   ```php
   function f1(){
   	static $v1 = 10;//静态变量
   }
   ```

   静态变量的特点：

   - 静态局部变量的值不会在函数调用结束时被销毁，而是会一直保留
     - 对比：非静态的局部变量会在函数调用结束时销毁
   - 也就是所，再次调用函数时 ，该变量的值该能被继续使用

4. 全局作用域和全局变量

   概念：就是函数外部范围的作用域，其中定义的变量就是全局变量

   注意：全局变量只能在其所在的全局作用域中可以直接使用

5. 超全局作用域与超全局变量

   概念：包括局部作用域和全局作用域的整个作用域范围，超全局变量可以在所有范围中使用

   系统预定义的变量也是超全局变量，包括：`$_GET，$_POST，$REQUEST`等

   

   一个特别的超全局变量：$GLOBALS

   概念：这是一个数组，其中存储着我们自己定义的所有全局变量，每个全局变量的变量名，就是$GLOBALS数组的一个单元

   案例：

   ```php
   $v1 = 1;			//这一行执行，就有了一个这个：$GLOBALS[‘v1’], 其值为1
   $v2 = ‘abc’;		//这一行执行，就有了一个这个：$GLOBALS[‘v2’], 其值为’abc’
   $v3 = true;		//这一行执行，就有了一个这个：$GLOBALS[‘v3’], 其值为true
   ```

   作用：可以让我们在局部作用域范围中使用全局变量

   演示：

   ```php
   $v1 = 1;
   function f1(){
   	echo $GLOBALS["v1"];//输出1
   	$s1 = $GLOBALS[‘v1’] * 5;	//结果为50；
   	echo $s1;
   }
   ```

   特别的关键字：`global`

   作用：

   - 用于在局部作用域中，修饰一个跟全局变量同名的局部变量
   - 此时该局部变量也可以使用全局变量的值了，其关系类似于变量引用，作用类似$GLOBALS

## 10.递归函数

基本含义：就是一个函数内部在调用该函数本身的一种形式

注意：如果函数在执行递归的过程中没有一个“不在调用“机制，那么就会出现无法停止的现象

案例：

```php
function f1($p1){
	$p1++;
	echo $p1;
	if($p<5){
		f1($p);
	}
	echo $p;
}
f1(1);
```



原理

![](C:\Users\宋天\Desktop\php\img\函数递归.png)